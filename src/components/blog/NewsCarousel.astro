---
// src/components/common/NewsletterBanner.astro
import { type Locale } from '../../i18n/i18n';

export interface Props {
  currentLang?: Locale;
  id?: string; 
  items?: any[];
}

const { currentLang, id, items } = Astro.props;

const data = Array.isArray(items) ? items : [];
const latestPost = data
  .slice()
  .sort((a, b) => String(b?.published_date || '').localeCompare(String(a?.published_date || '')))[0];
const latestTitle = String(latestPost?.title || '');
const latestSummary = String(latestPost?.summary || '');
const latestSlug = String(latestPost?.slug || latestPost?.id || '');
const latestHref = latestSlug ? `/${currentLang || 'es'}/blog/${latestSlug}` : '';

const content = {
  es: {
    bannerTitle: 'Tu nuevo sabor favorito: Zambos Ajo Parmesano',
    bannerSubtitle: 'Con la combinación perfecta de sabores que necesitas. Pruébalo ya',
    title: 'ÚNETE A NUESTRO BOLETÍN',
    subtitle: 'Entérate de nuestras últimas novedades en experiencias, sabores y más.',
    placeholder: 'Correo electrónico',
    button: 'Suscríbete'
  },
  en: {
    bannerTitle: 'Your new favorite flavor: Zambos Garlic Parmesan',
    bannerSubtitle: 'With the perfect combination of flavors you need. Try it now',
    title: 'JOIN OUR NEWSLETTER',
    subtitle: 'Stay informed about our latest news on experiences, flavors and more.',
    placeholder: 'Email address',
    button: 'Subscribe'
  }
};

const t = content[currentLang || 'es'];
---

<div class="w-full">
  <!-- Banner with Image -->
  <div class="relative w-full rounded-2xl overflow-hidden">
    <div class="w-full h-[400px] relative">
      <video 
        src="/images/en/video.mp4"
        class="w-full h-full object-cover blur-sm"
      />
      <div class="absolute inset-0 bg-black/20"></div>
    </div>
    
    <!-- Red Banner at Bottom -->
    <div class="absolute bottom-0 left-0 right-0 bg-red px-6 py-4">
      <div class="flex items-end justify-between gap-4">
        <div class="min-w-0">
          <p class="text-white font-bold text-sm md:text-base truncate">
            {latestTitle || t.bannerTitle}
          </p>
          <p class="text-white text-xs md:text-sm line-clamp-2">
            {latestSummary || t.bannerSubtitle}
          </p>
        </div>

        {latestHref && (
          <a
            href={latestHref}
            class="shrink-0 bg-white text-red font-bold px-6 py-3 rounded-full hover:opacity-90 transition"
          >
            {currentLang === 'es' ? 'Leer más' : 'Read more'}
          </a>
        )}
      </div>
    </div>
  </div>

  <!-- Green Newsletter Section -->
  <div class="bg-[#009337] text-center py-10 px-6 rounded-xl mt-[30px]">
    <h2 class="text-white text-2xl md:text-3xl font-bold mb-3 uppercase tracking-wider">
      {t.title}
    </h2>
    <p class="text-white text-sm md:text-base mb-6 max-w-xl mx-auto">
      {t.subtitle}
    </p>
    
           <a 
          href="https://www.snacksyummies.com/es/yummiesone" 
          class="submit-button bg-red"
          target="_blank"
          rel="noopener noreferrer"
        >
          {currentLang === 'es' ? 'Suscríbeme' : 'Subscribe'}
        </a>
  </div>
</div>

<style>
    .submit-button {
    padding: 12px 40px;
    font-size: 1rem;
    font-weight: 600;
    color: white;
   
    border: none;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 160px;
    position: relative;
    z-index: 25;
  }
</style>