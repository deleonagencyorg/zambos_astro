---
// src/components/common/ShareButton.astro
interface Props {
  platform: 'facebook' | 'instagram' | 'whatsapp';
  url: string;
  className?: string;
}

const { platform, url, className = '' } = Astro.props;

const shareHref = (() => {
  const u = encodeURIComponent(url);
  if (platform === 'facebook') return `https://www.facebook.com/sharer/sharer.php?u=${u}`;
  if (platform === 'whatsapp') return `https://api.whatsapp.com/send?text=${u}`;
  return '';
})();
---
{platform === 'instagram' ? (
  <button
    type="button"
    class={`inline-flex items-center justify-center text-black hover:opacity-80 transition ${className}`}
    aria-label="Instagram"
    onclick={`(function(){try{if(navigator.share){navigator.share({url: '${url.replace(/'/g, "\\'")}'});return;}}catch(e){}window.open('https://www.instagram.com/', '_blank');})()`}
  >
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="2" y="2" width="20" height="20" rx="5" ry="5" />
      <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
      <line x1="17.5" y1="6.5" x2="17.51" y2="6.5" />
    </svg>
  </button>
) : (
  <a
    href={shareHref}
    target="_blank"
    rel="noopener noreferrer"
    class={`inline-flex items-center justify-center text-black hover:opacity-80 transition ${className}`}
    aria-label={platform === 'facebook' ? 'Facebook' : 'WhatsApp'}
  >
    {platform === 'facebook' ? (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.1V12h2.1V9.8c0-2.1 1.3-3.3 3.2-3.3.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.2V12h2.2l-.4 2.9h-1.8v7A10 10 0 0 0 22 12z" />
      </svg>
    ) : (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20.52 3.48A11.91 11.91 0 0 0 12.01 0C5.38 0 .01 5.37.01 12c0 2.12.55 4.19 1.6 6.02L0 24l6.16-1.6A11.97 11.97 0 0 0 12.01 24C18.64 24 24 18.63 24 12c0-3.2-1.25-6.2-3.48-8.52zM12.01 21.8c-1.82 0-3.6-.49-5.17-1.42l-.37-.22-3.66.95.98-3.56-.24-.37A9.8 9.8 0 0 1 2.2 12c0-5.4 4.4-9.8 9.81-9.8 2.62 0 5.08 1.02 6.93 2.87A9.72 9.72 0 0 1 21.8 12c0 5.4-4.4 9.8-9.79 9.8zm5.67-7.36c-.31-.16-1.85-.91-2.13-1.01-.29-.11-.5-.16-.71.16-.21.31-.82 1.01-1 1.22-.19.21-.37.23-.68.08-.31-.16-1.31-.48-2.5-1.53-.92-.82-1.54-1.83-1.72-2.14-.18-.31-.02-.48.14-.63.14-.14.31-.37.47-.55.16-.19.21-.31.31-.52.1-.21.05-.39-.03-.55-.08-.16-.71-1.7-.97-2.33-.26-.62-.52-.54-.71-.55h-.61c-.21 0-.55.08-.84.39-.29.31-1.1 1.08-1.1 2.63s1.13 3.05 1.29 3.26c.16.21 2.23 3.41 5.4 4.78.75.32 1.34.51 1.79.65.75.24 1.43.2 1.97.12.6-.09 1.85-.76 2.11-1.49.26-.73.26-1.36.18-1.49-.08-.13-.29-.21-.6-.37z" />
      </svg>
    )}
  </a>
)}
