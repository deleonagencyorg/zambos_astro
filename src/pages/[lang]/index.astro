---
import { routesConfig, getRouteById } from '../../config/routes';
import { setLocale, t, type Locale } from '../../i18n/i18n';
import MainLayout from '../../layouts/MainLayout.astro';
import MainLayoutUS from '../../layouts/MainLayoutUS.astro';
import HomePageContent from '../../views/Home/index.astro';
import HomePageContentUS from '../../views-us/Home/index.astro';

export async function getStaticPaths() {
  const homeRoute = getRouteById('home');
  if (!homeRoute) return [];

  return Object.keys(homeRoute.slugs).map(lang => ({
    params: { lang },
  }));
}

const { lang } = Astro.params as { lang: Locale };
setLocale(lang);

const homeRoute = getRouteById('home');
if (!homeRoute) {
  // Manejar el caso en que la ruta 'home' no esté definida, aunque getStaticPaths debería prevenir esto.
  // Podrías redirigir a 404 o mostrar un error.
  throw new Error("Home route configuration is missing.");
}

const pageTitle = homeRoute.metaTitleKey ? t(homeRoute.metaTitleKey) : 'Home';
const pageDescription = homeRoute.metaDescriptionKey ? t(homeRoute.metaDescriptionKey) : '';

const isUS = lang === 'us';
const Layout = isUS ? MainLayoutUS : MainLayout;
const ContentComponent = isUS ? HomePageContentUS : HomePageContent;

// SEO Keywords based on language
const seoKeywords = lang === 'es' 
  ? 'snacks centroamérica, taqueritos, zambos, ranchitas, snacks honduras, snacks guatemala, marca líder snacks, snacks yummies'
  : 'central america snacks, food, honduras snacks, guatemala snacks, leading snack brand, snacks yummies, taqueritos, zambos, ranchitas';
---
<Layout title={pageTitle} description={pageDescription}>
  <Fragment slot="head">
    <!-- SEO Meta Tags -->
    <meta name="keywords" content={seoKeywords}>
    <meta name="author" content="Zambos">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href={`https://zambos.com/${lang}`}>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content={`Zambos - ${pageTitle}`}>
    <meta property="og:description" content={pageDescription}>
    <meta property="og:image" content="https://snack.yummiespromociones.com/SnacksyummiesAssets/zibas-logo-3.webp">
    <meta property="og:url" content={`https://zambos.com/${lang}`}>
    <meta property="og:type" content="website"> 
    <meta property="og:site_name" content="Zambos">
    <meta property="og:locale" content={lang === 'es' ? 'es_ES' : 'en_US'}>
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content={`Zambos - ${pageTitle}`}>
    <meta name="twitter:description" content={pageDescription}>
    <meta name="twitter:image" content="https://snack.yummiespromociones.com/SnacksyummiesAssets/zibas-logo-3.webp">
    <meta name="twitter:site" content="@zibas">
    
    <!-- Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Zambos",
      "alternateName": "Zambos",
      "url": "https://zambos.com",
      "logo": "https://snack.yummiespromociones.com/SnacksyummiesAssets/zibas-logo-3.webp",
      "description": lang === 'es' ? "Marca líder de snacks en Centroamérica. Taqueritos, Zambos, Ranchitas. Calidad y sabor inigualable." : "Leading snack brand in Central America. Taqueritos, Zambos, Ranchitas. Unmatched quality and flavor.",
      "foundingDate": "1990",
      "areaServed": [
        "Honduras",
        "Guatemala", 
        "El Salvador",
        "Nicaragua",
        "Costa Rica",
        "República Dominicana"
      ],
      "brand": [
        {
          "@type": "Brand",
          "name": "Zambos",
          "url": "https://zambos.com"
        }
      ],
      "sameAs": [
        "https://www.instagram.com/zambosusa/",
        "https://www.instagram.com/zambosusa/",
        "https://www.tiktok.com/@zambosusa", 
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+504-2275-3370",
        "contactType": "customer service",
        "availableLanguage": ["Spanish", "English"],
        "hoursAvailable": "Mo-Fr 08:00-17:00"
      },
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Barrio Morazán, Frente a Plantas Tropicales, Bulevar Suyapa",
        "addressLocality": "Tegucigalpa",
        "addressCountry": "Honduras"
      }
    })}></script>
    
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Zambos",
      "url": "https://zambos.com",
      "description": lang === 'es' ? "Sitio web oficial de Zambos, la marca líder de snacks en Centroamérica" : "Official website of Zambos, the leading snack brand in Central America",
      "inLanguage": lang === 'es' ? "es-ES" : "en-US",
      "potentialAction": {
        "@type": "SearchAction",
        "target": `https://zambos.com/${lang}/search?q={search_term_string}`,
        "query-input": "required name=search_term_string"
      }
    })}></script>
    
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": lang === 'es' ? "Inicio" : "Home",
          "item": `https://zambos.com/${lang}`
        }
      ]
    })}></script>
  </Fragment>
  <ContentComponent />
</Layout>

